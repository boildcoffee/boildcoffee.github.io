<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="boildcoffee 技术交流"><meta name="keywords" content="android,boildcoffee"><title>a-z字母导航栏 | boildcoffee</title><link rel="stylesheet" type="text/css" href="//fonts.css.network/css?family=Source+Code+Pro"><link rel="stylesheet" type="text/css" href="/css/style.css?v=2.0.1"><link rel="stylesheet" type="text/css" href="/css/highlight.css?v=2.0.1"><link rel="Shortcut Icon" href="/favicon.ico"><link rel="bookmark" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">a-z字母导航栏</h1><a id="logo" href="/.">boildcoffee</a><p class="description"></p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div><div id="search-form"><div id="result-mask" class="hide"></div><label><input id="search-key" type="text" autocomplete="off" placeholder="Arama"></label><div id="result-wrap" class="hide"><div id="search-result"></div></div><div class="hide"><template id="search-tpl"><div class="item"><a href="/{path}" title="{title}"><div class="title">{title}</div><div class="time">{date}</div><div class="tags">{tags}</div></a></div></template></div></div></div><div id="layout" class="layout-g"><div class="layout-l"><div class="content_container"><div class="post"><h1 class="post-title">a-z字母导航栏</h1><div class="post-meta"><a href="/2017/09/29/android-slidebar/#comments" class="comment-count"></a><p><span class="date">Sep 29, 2017</span><span><a href="/categories/android/" class="category">android</a></span><span><i id="busuanzi_container_page_pv"><i id="busuanzi_value_page_pv"></i><i>点击</i></i></span></p></div><div class="post-content"><p>先上张demo的效果图<br><img src="http://upload-images.jianshu.io/upload_images/2898841-667d52dcdfff7360.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="sidebarDemoImg.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/2898841-b77bab62aca7a099.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="QQ截图20160909164412.png"></p>
<p>从图上可以看到该布局由2部分组成,ListView和右边的sidebar组成,那么我们要实现自己的字母导航就需要知道:<br>1.如何自定义Sidebar绘制出a-z<br>2.如何将sidebar与Listview结合 实现字母导航</p>
<h3 id="自定义Sidebar"><a href="#自定义Sidebar" class="headerlink" title="自定义Sidebar"></a>自定义Sidebar</h3><h4 id="绘制UI"><a href="#绘制UI" class="headerlink" title="绘制UI"></a>绘制UI</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Sidebar</span> <span class="keyword">extends</span> <span class="title">View</span></span>&#123;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String[] alphabets = <span class="keyword">new</span> String[]&#123; <span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>, <span class="string">"D"</span>, <span class="string">"E"</span>, <span class="string">"F"</span>, <span class="string">"G"</span>, <span class="string">"H"</span>, <span class="string">"I"</span>,</div><div class="line">            <span class="string">"J"</span>, <span class="string">"K"</span>, <span class="string">"L"</span>, <span class="string">"M"</span>, <span class="string">"N"</span>, <span class="string">"O"</span>, <span class="string">"P"</span>, <span class="string">"Q"</span>, <span class="string">"R"</span>, <span class="string">"S"</span>, <span class="string">"T"</span>, <span class="string">"U"</span>, <span class="string">"V"</span>, <span class="string">"W"</span>, <span class="string">"X"</span>, <span class="string">"Y"</span>, <span class="string">"Z"</span>, <span class="string">"#"</span> &#125;;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> selectedPosition; <span class="comment">//选中字母的位置</span></div><div class="line">    <span class="keyword">private</span> Paint mPaint;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> cellHeight; <span class="comment">//每一个字母的高度</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> alphabetDefaultColor;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">float</span> textSize;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Sidebar</span><span class="params">(Context context)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(context);</div><div class="line">        init();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Sidebar</span><span class="params">(Context context, AttributeSet attrs)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(context, attrs);</div><div class="line">        init();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Sidebar</span><span class="params">(Context context, AttributeSet attrs, <span class="keyword">int</span> defStyleAttr)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(context, attrs, defStyleAttr);</div><div class="line">        init();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</div><div class="line">        textSize = TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_SP, <span class="number">12</span>, getResources().getDisplayMetrics());</div><div class="line">        mPaint = <span class="keyword">new</span> Paint();</div><div class="line">        mPaint.setAntiAlias(<span class="keyword">true</span>);</div><div class="line">        mPaint.setTextSize(textSize);</div><div class="line">        alphabetDefaultColor = Color.GRAY;</div><div class="line">        alphabetSelectedColor = Color.RED;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onDraw</span><span class="params">(Canvas canvas)</span> </span>&#123;</div><div class="line">        cellHeight = getHeight() / alphabets.length;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt; alphabets.length; i++)&#123;</div><div class="line">            drawAlphabet(canvas,i);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">drawAlphabet</span><span class="params">(Canvas canvas,<span class="keyword">int</span> positon)</span> </span>&#123;</div><div class="line">        String alphabet = alphabets[positon];</div><div class="line">        mPaint.setColor(alphabetDefaultColor);</div><div class="line"></div><div class="line">        <span class="keyword">int</span> baseLine = (positon+<span class="number">1</span>) * cellHeight; <span class="comment">//position是从0开始的所以需要+1</span></div><div class="line">        canvas.drawText(alphabet, (getWidth() - mPaint.measureText(alphabet)) / <span class="number">2</span>, baseLine, mPaint);</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">float</span> <span class="title">getTextSize</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (mPaint == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="keyword">return</span> mPaint.getTextSize();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTextSize</span><span class="params">(<span class="keyword">float</span> textSize)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (mPaint == <span class="keyword">null</span>) <span class="keyword">return</span> ;</div><div class="line">        mPaint.setTextSize(textSize);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>drawAlphabet方法主要实现a-z从上到下的绘制工作,其中需要注意的是canvas.drawText的第3个参数Y指的是基线(参考文章:<a href="https://zh.wikipedia.org/wiki/%E5%9F%BA%E7%B7%9A" target="_blank" rel="external">https://zh.wikipedia.org/wiki/%E5%9F%BA%E7%B7%9A</a>).<br><img src="http://upload-images.jianshu.io/upload_images/2898841-084599a04c5ccc77.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="410px-Typography_Line_Terms.svg.png">   </p>
<p><img src="http://upload-images.jianshu.io/upload_images/2898841-b9e9c2ca42581e94.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="QQ截图20160909144330.png"><br>从上图我们能知道<code>D基线=(4/3)C基线=2B基线=4A基线</code>,因此每一个字母的基线就等于它所处位置*字母的高度。<br>我们要让字母水平居中显示所以canvas.drawText 的第二个参数水平方向的位置就应该是 (view的总宽度-绘制字母的长度)/2。<br>完成以上步骤后我们就能成功绘制出a-z。</p>
<h4 id="监听onTouch事件-计算出被选中字母的位置并提供回调函数"><a href="#监听onTouch事件-计算出被选中字母的位置并提供回调函数" class="headerlink" title="监听onTouch事件,计算出被选中字母的位置并提供回调函数"></a>监听onTouch事件,计算出被选中字母的位置并提供回调函数</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Sidebar</span> <span class="keyword">extends</span> <span class="title">View</span></span>&#123;</div><div class="line">    ...</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">drawAlphabet</span><span class="params">(Canvas canvas,<span class="keyword">int</span> positon)</span> </span>&#123;</div><div class="line">        String alphabet = alphabets[positon];</div><div class="line"></div><div class="line">        mPaint.setColor(alphabetDefaultColor);</div><div class="line">        <span class="keyword">if</span> (isPressed())&#123;</div><div class="line">            <span class="keyword">if</span> (positon == selectedPosition)&#123;</div><div class="line">                mPaint.setColor(alphabetSelectedColor);</div><div class="line">                <span class="keyword">if</span> (onAlphabetChangeListener != <span class="keyword">null</span>)&#123;</div><div class="line">                    onAlphabetChangeListener.alphabetChangeListener(<span class="keyword">this</span>,alphabet,positon);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">int</span> baseLine = (positon+<span class="number">1</span>) * cellHeight;</div><div class="line">        canvas.drawText(alphabet, (getWidth() - mPaint.measureText(alphabet)) / <span class="number">2</span>, baseLine, mPaint);</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onTouchEvent</span><span class="params">(MotionEvent event)</span> </span>&#123;</div><div class="line">        <span class="keyword">switch</span> (event.getAction())&#123;</div><div class="line">            <span class="keyword">case</span> MotionEvent.ACTION_DOWN:</div><div class="line">                setPressed(<span class="keyword">true</span>);</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            <span class="keyword">case</span> MotionEvent.ACTION_MOVE:</div><div class="line">                <span class="keyword">float</span> y = event.getY();</div><div class="line">                selectedPosition = (<span class="keyword">int</span>)(Math.ceil((y / cellHeight)) - <span class="number">1</span>); <span class="comment">//postion是从0开始的,所以需要-1</span></div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            <span class="keyword">case</span> MotionEvent.ACTION_UP:</div><div class="line">                setPressed(<span class="keyword">false</span>);</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">        invalidate();</div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">OnAlphabetChangeListener</span></span>&#123;</div><div class="line">        <span class="function"><span class="keyword">void</span> <span class="title">alphabetChangeListener</span><span class="params">(View v,String alphabet,<span class="keyword">int</span> position)</span></span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> OnAlphabetChangeListener <span class="title">getOnAlphabetChangeListener</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> onAlphabetChangeListener;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOnAlphabetChangeListener</span><span class="params">(OnAlphabetChangeListener onAlphabetChangeListener)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.onAlphabetChangeListener = onAlphabetChangeListener;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这里主要说明下Math.ceil()函数的作用是向上取整即:1.1 = 2,1.5=2。通过Math.ceil((y / cellHeight)我们就可以计算出当前手指选中的是那个字母的位置。为了能让用户知道他当前选中的是哪个字母,我们可以在onTouchEvent return前调用invalidate,<br>调用invalidate后会重新绘制页面,onDraw方法会被调用,所以我们可以在drawAlphabet中加上当前要绘制的字母是否被用户选中,是则采用其他颜色绘制。最后就是提供回调函数alphabetChangeListener,该回调函数是用于与listview实现字母导航。</p>
<h3 id="与ListView实现字母导航"><a href="#与ListView实现字母导航" class="headerlink" title="与ListView实现字母导航"></a>与ListView实现字母导航</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</div><div class="line"><span class="tag">&lt;<span class="name">RelativeLayout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></div><div class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">"http://schemas.android.com/tools"</span></span></div><div class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></div><div class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></div><div class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">"com.jason.sidebardemo.MainActivity"</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">ListView</span></span></div><div class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/list"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:divider</span>=<span class="string">"@null"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span>/&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">com.jason.library.widget.Sidebar</span></span></div><div class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/sidebar"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:layout_alignParentRight</span>=<span class="string">"true"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"30dp"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span> /&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</div><div class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></div><div class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">"vertical"</span> <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></div><div class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></div><div class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/tv_header"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:visibility</span>=<span class="string">"gone"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"30dp"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:gravity</span>=<span class="string">"center_vertical"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:paddingLeft</span>=<span class="string">"5dp"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:background</span>=<span class="string">"@android:color/darker_gray"</span> /&gt;</span></div><div class="line"></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></div><div class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/tv_name"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"30dp"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:gravity</span>=<span class="string">"center_vertical"</span></span></div><div class="line"><span class="tag">        <span class="attr">android:paddingLeft</span>=<span class="string">"10dp"</span> /&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></div></pre></td></tr></table></figure>
<p>上面为activity和listview item的布局文件.<br>要使用Listview主要就是设置adapter,那么我们就先看adapter的代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyAdapter</span> <span class="keyword">extends</span> <span class="title">BaseAdapter</span> <span class="keyword">implements</span> <span class="title">SectionIndexer</span></span>&#123;</div><div class="line">    <span class="keyword">private</span> Context mContext;</div><div class="line">    <span class="keyword">private</span> List&lt;Contact&gt; mContacts;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyAdapter</span><span class="params">(Context context,List&lt;Contact&gt; contacts)</span></span>&#123;</div><div class="line">        mContext = context;</div><div class="line">        mContacts = contacts;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCount</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> mContacts.size();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">getItem</span><span class="params">(<span class="keyword">int</span> position)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> mContacts.get(position);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getItemId</span><span class="params">(<span class="keyword">int</span> position)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> position;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> View <span class="title">getView</span><span class="params">(<span class="keyword">int</span> position, View convertView, ViewGroup parent)</span> </span>&#123;</div><div class="line">        ViewHolder viewHolder;</div><div class="line">        <span class="keyword">if</span> (convertView == <span class="keyword">null</span>)&#123;</div><div class="line">            viewHolder = <span class="keyword">new</span> ViewHolder();</div><div class="line">            convertView = LayoutInflater.from(mContext).inflate(R.layout.item_contact, <span class="keyword">null</span>);</div><div class="line">            viewHolder.tvHeader = (TextView) convertView.findViewById(R.id.tv_header);</div><div class="line">            viewHolder.tvName = (TextView) convertView.findViewById(R.id.tv_name);</div><div class="line">            convertView.setTag(viewHolder);</div><div class="line">        &#125;<span class="keyword">else</span> &#123;</div><div class="line">            viewHolder = (ViewHolder) convertView.getTag();</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (position == <span class="number">0</span>)&#123; <span class="comment">//第1个需要显示首字母</span></div><div class="line">            viewHolder.tvHeader.setVisibility(View.VISIBLE);</div><div class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span> (mContacts.get(position).getFirstAlphabet().charAt(<span class="number">0</span>) != mContacts.get(position - <span class="number">1</span>).getFirstAlphabet().charAt(<span class="number">0</span>))&#123;</div><div class="line">            <span class="comment">//前后2个首字母不相同,需要显示首字母</span></div><div class="line">            viewHolder.tvHeader.setVisibility(View.VISIBLE);</div><div class="line">        &#125;<span class="keyword">else</span> &#123;</div><div class="line">            viewHolder.tvHeader.setVisibility(View.GONE);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        viewHolder.tvHeader.setText(mContacts.get(position).getFirstAlphabet());</div><div class="line">        viewHolder.tvName.setText(mContacts.get(position).getName());</div><div class="line"></div><div class="line">        <span class="keyword">return</span> convertView;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="keyword">public</span> Object[] getSections() &#123;</div><div class="line">        <span class="keyword">return</span> Arrays.copyOf(Sidebar.alphabets,Sidebar.alphabets.length);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getPositionForSection</span><span class="params">(<span class="keyword">int</span> sectionIndex)</span> </span>&#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;getCount(); i++)&#123;</div><div class="line">            <span class="keyword">if</span> (((String)getSections()[sectionIndex]).charAt(<span class="number">0</span>) == mContacts.get(i).getFirstAlphabet().charAt(<span class="number">0</span>))&#123;</div><div class="line">                <span class="keyword">return</span> i;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getSectionForPosition</span><span class="params">(<span class="keyword">int</span> position)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">ViewHolder</span></span>&#123;</div><div class="line">        <span class="keyword">public</span> TextView tvHeader;</div><div class="line">        <span class="keyword">public</span> TextView tvName;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Contact</span> <span class="keyword">implements</span> <span class="title">Comparable</span></span>&#123;</div><div class="line">    <span class="keyword">private</span> String firstAlphabet; <span class="comment">//名字的第一个字的首字母</span></div><div class="line">    <span class="keyword">private</span> String name;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Contact</span><span class="params">(String name)</span> </span>&#123;</div><div class="line">        setName(name);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getFirstAlphabet</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> firstAlphabet;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> name;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.name = name;</div><div class="line">        firstAlphabet = PinYin4jUtil.getFirstAlphabet(name);  <span class="comment">//获取第一个字符的字母,若为中文则使用pinyin4j获取第一个字的拼音的第一个字符,若为英文字母获取第一个字母,否则返回#</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compareTo</span><span class="params">(Object another)</span> </span>&#123;</div><div class="line">        Contact compareContact = (Contact) another;</div><div class="line">        <span class="keyword">if</span> (compareContact.getFirstAlphabet().equals(<span class="string">"#"</span>))&#123;</div><div class="line">            <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span> (getFirstAlphabet().equals(<span class="string">"#"</span>))&#123;</div><div class="line">            <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">        &#125;<span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">return</span> getFirstAlphabet().compareTo(((Contact) another).getFirstAlphabet());</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>在这里有2点需要说明下的：<br>1.a-z字母导航的数据源必须经过a-z排序,Contact类通过实现Comparable提供对象排序算法.<code>(A&gt;B return 1,A=B return 0,A&lt;B return -1)</code><br>2.Listview的adapter需要实现SectionIndexer接口,SectionIndexer接口需要实现3个方法<code>getSections(),getPositionForSection(int sectionIndex),getSectionForPosition(int position)</code><br>,getSections返回的值为章节数组即<code>(a-z字符数组)</code>，getPositionForSection通过章节位置<code>(Sidebar中a-z的位置)</code>获取position的起始位置,getSectionForPosition通过位置获取对应的章节.<br>其中需要说明下section和position的关系,其实就和书的章节与页数一样,第一章有100页,那么<code>0-100(postion)</code>就对应<code>第一章(section)</code>.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</div><div class="line">    ListView mListView;</div><div class="line">    Sidebar mSidebar;</div><div class="line">    MyAdapter mAdapter;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line">        setContentView(R.layout.activity_main);</div><div class="line"></div><div class="line">        initView();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initView</span><span class="params">()</span> </span>&#123;</div><div class="line">        mListView = (ListView) findViewById(R.id.list);</div><div class="line">        mSidebar = (Sidebar) findViewById(R.id.sidebar);</div><div class="line">        mSidebar.setOnAlphabetChangeListener(<span class="keyword">new</span> Sidebar.OnAlphabetChangeListener() &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">alphabetChangeListener</span><span class="params">(View v, String alphabet, <span class="keyword">int</span> position)</span> </span>&#123;</div><div class="line">                mListView.setSelection(mAdapter.getPositionForSection(position));</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">        mAdapter = <span class="keyword">new</span> MyAdapter(<span class="keyword">this</span>, getDatas());</div><div class="line">        mListView.setAdapter(mAdapter);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> List&lt;Contact&gt; <span class="title">getDatas</span><span class="params">()</span> </span>&#123;</div><div class="line">        List&lt;Contact&gt; datas = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">        datas.add(<span class="keyword">new</span> Contact(<span class="string">"小熊"</span>));</div><div class="line">        datas.add(<span class="keyword">new</span> Contact(<span class="string">"小明"</span>));</div><div class="line">        datas.add(<span class="keyword">new</span> Contact(<span class="string">"老王"</span>));</div><div class="line">        datas.add(<span class="keyword">new</span> Contact(<span class="string">"老宋"</span>));</div><div class="line">        datas.add(<span class="keyword">new</span> Contact(<span class="string">"李死"</span>));</div><div class="line">        datas.add(<span class="keyword">new</span> Contact(<span class="string">"小张"</span>));</div><div class="line">        datas.add(<span class="keyword">new</span> Contact(<span class="string">"王五"</span>));</div><div class="line">        datas.add(<span class="keyword">new</span> Contact(<span class="string">"jason"</span>));</div><div class="line">        datas.add(<span class="keyword">new</span> Contact(<span class="string">"java"</span>));</div><div class="line">        datas.add(<span class="keyword">new</span> Contact(<span class="string">"python"</span>));</div><div class="line">        datas.add(<span class="keyword">new</span> Contact(<span class="string">"c"</span>));</div><div class="line">        datas.add(<span class="keyword">new</span> Contact(<span class="string">"c#"</span>));</div><div class="line">        datas.add(<span class="keyword">new</span> Contact(<span class="string">"c++"</span>));</div><div class="line">        datas.add(<span class="keyword">new</span> Contact(<span class="string">"盲僧"</span>));</div><div class="line">        datas.add(<span class="keyword">new</span> Contact(<span class="string">"蛮王"</span>));</div><div class="line">        datas.add(<span class="keyword">new</span> Contact(<span class="string">"剑圣"</span>));</div><div class="line">        datas.add(<span class="keyword">new</span> Contact(<span class="string">"赵兴"</span>));</div><div class="line">        datas.add(<span class="keyword">new</span> Contact(<span class="string">"女警"</span>));</div><div class="line">        datas.add(<span class="keyword">new</span> Contact(<span class="string">"亚索"</span>));</div><div class="line">        datas.add(<span class="keyword">new</span> Contact(<span class="string">"狗熊"</span>));</div><div class="line">        datas.add(<span class="keyword">new</span> Contact(<span class="string">"刀妹"</span>));</div><div class="line">        datas.add(<span class="keyword">new</span> Contact(<span class="string">"吸血鬼"</span>));</div><div class="line">        datas.add(<span class="keyword">new</span> Contact(<span class="string">"卡萨丁"</span>));</div><div class="line">        datas.add(<span class="keyword">new</span> Contact(<span class="string">"火女"</span>));</div><div class="line">        datas.add(<span class="keyword">new</span> Contact(<span class="string">"女枪"</span>));</div><div class="line">        datas.add(<span class="keyword">new</span> Contact(<span class="string">"奥巴马"</span>));</div><div class="line">        Collections.sort(datas);  <span class="comment">//排序数据</span></div><div class="line">        <span class="keyword">return</span> datas;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>最后就是通过alphabetChangeListener回调与listview实现导航功能,通过mAdapter.getPositionForSection()获取到选中字母的第一个条目的位置,再通过mListView.setSelection()让ListView定位到该条目上   </p>
<p>附上demo地址:<a href="https://github.com/aii1991/SidebarDemo" target="_blank" rel="external">https://github.com/aii1991/SidebarDemo</a></p>
</div><div class="tags"><a href="/tags/java-android/">java android</a></div><div class="post-share"><div class="bdsharebuttonbox"><span style="float:left;line-height: 28px;height: 28px;font-size:16px;font-weight:blod">分享到：</span><a href="#" data-cmd="more" class="bds_more"></a><a href="#" data-cmd="mshare" title="分享到一键分享" class="bds_mshare"></a><a href="#" data-cmd="fbook" title="分享到Facebook" class="bds_fbook"></a><a href="#" data-cmd="twi" title="分享到Twitter" class="bds_twi"></a><a href="#" data-cmd="linkedin" title="分享到linkedin" class="bds_linkedin"></a><a href="#" data-cmd="youdao" title="分享到有道云笔记" class="bds_youdao"></a><a href="#" data-cmd="evernotecn" title="分享到印象笔记" class="bds_evernotecn"></a><a href="#" data-cmd="weixin" title="分享到微信" class="bds_weixin"></a><a href="#" data-cmd="qzone" title="分享到QQ空间" class="bds_qzone"></a><a href="#" data-cmd="tsina" title="分享到新浪微博" class="bds_tsina"></a></div></div><div class="post-nav"><a href="/2017/09/29/android-rv-loadmore/" class="pre">recycleView下拉刷新上拉加载更多封装</a><a href="/2017/09/29/android-clip-view/" class="next">自定义裁剪view</a></div><div id="comments"></div></div></div></div><div class="layout-r"><div id="sidebar"><div class="search-pla"></div><div id="toc" class="widget"><div class="widget-title"><i class="fa fa-fei">文章目录</i></div><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#自定义Sidebar"><span class="toc-text">自定义Sidebar</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#绘制UI"><span class="toc-text">绘制UI</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#监听onTouch事件-计算出被选中字母的位置并提供回调函数"><span class="toc-text">监听onTouch事件,计算出被选中字母的位置并提供回调函数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#与ListView实现字母导航"><span class="toc-text">与ListView实现字母导航</span></a></li></ol></div><div class="widget"><div class="widget-title"><i class="fa fa-xie"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/09/29/android-task-queue/">任务队列的实现</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/29/android-rv-loadmore/">recycleView下拉刷新上拉加载更多封装</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/29/android-slidebar/">a-z字母导航栏</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/29/android-clip-view/">自定义裁剪view</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/28/android-retrofit/">retrofit+rxjava封装</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-gui"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/android/">android</a><span class="category-list-count">5</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-biao"> 标签</i></div><div class="tagcloud"><a href="/tags/java-android/" style="font-size: 15px;">java android</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-archive"> 归档</i></div><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">九月 2017</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-you"> 友情链接</i></div><ul></ul><a href="http://yovenny.tech" title="yovenny" target="_blank">yovenny</a></div></div></div></div><a id="totop" href="#top"></a><div id="footer"><div class="footer-info"><p><a href="/baidusitemap.xml">Baidu Site Haritası</a> |  <a href="/atom.xml">订阅</a> |  <a href="/about/">关于</a></p><p>本站总访问量：<i id="busuanzi_container_site_pv"><i id="busuanzi_value_site_pv"></i></i>次</p><p><span> Copyright &copy;<a href="/." rel="nofollow">boildcoffe jason zhang.</a></span><span> Theme by<a rel="nofollow" target="_blank" href="https://github.com/chaooo/hexo-theme-BlueLake"> BlueLake.</a></span><span> Count by<a href="http://busuanzi.ibruce.info/"> busuanzi.</a></span><span> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a></span></p></div></div></div><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><script type="text/javascript" src="/js/search.json.js?v=2.0.1"></script><script type="text/javascript" src="/js/toctotop.js?v=2.0.1" async></script><script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":["mshare","weixin","tsina","qzone","linkedin","fbook","twi","print","renren","sqq","evernotecn","bdysc","tqq","tqf","bdxc","kaixin001","tieba","douban","bdhome","thx","ibaidu","meilishuo","mogujie","diandian","huaban","duitang","hx","fx","youdao","sdo","qingbiji","people","xinhua","mail","isohu","yaolan","wealink","ty","iguba","h163","copy"],"bdPic":"","bdStyle":"1","bdSize":"16"},"share":{},"image":{"viewList":["tsina","qzone","weixin","fbook","twi","linkedin","youdao","evernotecn","mshare"],"viewText":"分享到：","viewSize":"16"},"selectShare":{"bdContainerClass":null,"bdSelectMiniList":["tsina","qzone","weixin","fbook","twi","linkedin","youdao","evernotecn","mshare"]}};with(document)0[(getElementsByTagName('head')[0]||head).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
</script></body></html>